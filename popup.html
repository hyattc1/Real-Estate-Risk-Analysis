<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real Estate Risk Analysis</title>
    <link rel="stylesheet" href="popup.css">
    <!-- Chart.js CDN with multiple fallbacks -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js"></script>
    <script>
        // Fallback if Chart.js fails to load
        if (typeof Chart === 'undefined') {
            console.log('Chart.js not loaded from primary CDN, trying fallback...');
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js';
            document.head.appendChild(script);
        }
    </script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>üè† Real Estate Risk Analysis</h1>
            <div class="source-badge" id="sourceBadge">Loading...</div>
        </header>

        <!-- Risk Analysis Dashboard -->
        <section class="dashboard">
            <!-- 1. Price Analysis -->
            <div class="card price-analysis">
                <h3>üí∞ Price Analysis (0.5-1 mile radius, similar properties)</h3>
                <div class="price-comparison">
                    <div class="price-item">
                        <span class="label">Median Area Price:</span>
                        <span class="value" id="medianPrice">-</span>
                    </div>
                    <div class="price-item">
                        <span class="label">Price vs Median:</span>
                        <span class="value" id="priceVsMedian">-</span>
                    </div>
                    <div class="price-item">
                        <span class="label">Price per Sqft:</span>
                        <span class="value" id="pricePerSqft">-</span>
                    </div>
                    <div class="price-item">
                        <span class="label">Market Position:</span>
                        <span class="outlier-badge" id="marketPosition">-</span>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="priceChart"></canvas>
                </div>
            </div>

            <!-- 2. Median Income -->
            <div class="card median-income">
                <h3>üí∞ Median Income (0.5 mile radius)</h3>
                <div class="income-section">
                    <div class="income-item">
                        <span class="label">Median Household Income:</span>
                        <span class="value" id="medianIncome">-</span>
                    </div>
                    <div class="income-item">
                        <span class="label">Rent Affordability:</span>
                        <span class="value" id="rentAffordability">-</span>
                    </div>
                    <div class="income-item">
                        <span class="label">Neighborhood Stability:</span>
                        <span class="stability-badge" id="neighborhoodStability">-</span>
                    </div>
                </div>
            </div>

            <!-- 3. Property Crime Rate -->
            <div class="card crime-risk">
                <h3>üöì Property Crime Rate</h3>
                <div class="crime-section">
                    <div class="crime-item">
                        <span class="label">Crime Risk Level:</span>
                        <span class="crime-badge" id="crimeRiskBadge">Loading...</span>
                    </div>
                    <div class="crime-item">
                        <span class="label">Crime Index:</span>
                        <span class="value" id="crimeRiskScore"></span>
                    </div>
                    <div class="crime-item">
                        <span class="label">Safety Rating:</span>
                        <span class="safety-badge" id="safetyRating">-</span>
                    </div>
                </div>
                <div class="crime-map-container">
                    <div class="crime-map-placeholder" id="crimeMapPlaceholder">
                        <p>Crime heatmap visualization would appear here</p>
                        <small>Similar to crimegrade.org property crime maps</small>
                    </div>
                </div>
            </div>

            <!-- 4. Market Risk Section -->
            <div class="card market-risk">
                <h3>üö© Market Risk Analysis</h3>
                <div class="risk-factors">
                    <div class="risk-factor">
                        <span class="factor-label">Vacancy Rate:</span>
                        <span class="factor-value" id="vacancyRate">-</span>
                        <span class="risk-indicator" id="vacancyRisk">-</span>
                    </div>
                    <div class="risk-factor">
                        <span class="factor-label">Population Growth (5yr):</span>
                        <span class="factor-value" id="populationGrowth">-</span>
                        <span class="risk-indicator" id="populationRisk">-</span>
                    </div>
                    <div class="risk-factor">
                        <span class="factor-label">Job Growth Rate:</span>
                        <span class="factor-value" id="jobGrowth">-</span>
                        <span class="risk-indicator" id="jobRisk">-</span>
                    </div>
                </div>
                <div class="overall-risk">
                    <span class="label">Overall Market Risk:</span>
                    <span class="market-risk-badge" id="overallMarketRisk">-</span>
                </div>
            </div>

            <!-- 5. Rent by Room Viability -->
            <div class="card rent-viability">
                <h3>üè• Rent by Room Viability</h3>
                <div class="viability-section">
                    <div class="viability-item">
                        <span class="label">Nearby Institutions:</span>
                        <span class="value" id="nearbyInstitutions">-</span>
                    </div>
                    <div class="viability-item">
                        <span class="label">Viability Status:</span>
                        <span class="viability-badge" id="rentViability">-</span>
                    </div>
                    <div class="viability-item">
                        <span class="label">Expected Rent Boost:</span>
                        <span class="value" id="rentBoost">-</span>
                    </div>
                    <div class="viability-item">
                        <span class="label">Vacancy Risk Reduction:</span>
                        <span class="value" id="vacancyReduction">-</span>
                    </div>
                </div>
            </div>

            <!-- 6. Demographics -->
            <div class="card demographics">
                <h3>üåç Demographics (0.5 mile radius)</h3>
                <div class="demographics-grid">
                    <div class="demo-item">
                        <span class="demo-label">White:</span>
                        <span class="demo-value" id="whitePercent">-</span>
                    </div>
                    <div class="demo-item">
                        <span class="demo-label">Black:</span>
                        <span class="demo-value" id="blackPercent">-</span>
                    </div>
                    <div class="demo-item">
                        <span class="demo-label">Hispanic:</span>
                        <span class="demo-value" id="hispanicPercent">-</span>
                    </div>
                    <div class="demo-item">
                        <span class="demo-label">Asian:</span>
                        <span class="demo-value" id="asianPercent">-</span>
                    </div>
                    <div class="demo-item">
                        <span class="demo-label">Other:</span>
                        <span class="demo-value" id="otherPercent">-</span>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="demographicsChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Error/Status Messages -->
        <div class="status-message" id="statusMessage"></div>

        <!-- Footer -->
        <footer class="footer">
            <p>Data provided for educational purposes only</p>
        </footer>
    </div>

    <script src="popup.js"></script>
</body>
</html> 